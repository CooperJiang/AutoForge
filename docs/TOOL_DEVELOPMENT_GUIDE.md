# ğŸ”§ Cooper å·¥å…·å¼€å‘æŒ‡å—

> å®Œæ•´çš„å·¥å…·å¼€å‘æ•™ç¨‹ - ä»åç«¯å®ç°åˆ°å‰ç«¯é…ç½®ç•Œé¢

## ğŸ“‹ ç›®å½•

- [æ¦‚è¿°](#-æ¦‚è¿°)
- [åç«¯å¼€å‘](#-åç«¯å¼€å‘)
- [å‰ç«¯å¼€å‘](#-å‰ç«¯å¼€å‘)
- [å®Œæ•´ç¤ºä¾‹](#-å®Œæ•´ç¤ºä¾‹)
- [æœ€ä½³å®è·µ](#-æœ€ä½³å®è·µ)
- [å¸¸è§é—®é¢˜](#-å¸¸è§é—®é¢˜)

---

## ğŸ¯ æ¦‚è¿°

Cooper ä½¿ç”¨æ’ä»¶åŒ–çš„å·¥å…·ç³»ç»Ÿï¼Œæ¯ä¸ªå·¥å…·éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ã€‚å·¥å…·å¼€å‘åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š

1. **åç«¯å·¥å…·å®ç°** - å®ç°å·¥å…·çš„æ ¸å¿ƒé€»è¾‘ï¼ˆGoï¼‰
2. **å‰ç«¯å›¾æ ‡é…ç½®** - é…ç½®å·¥å…·çš„å›¾æ ‡ã€æ ‡ç­¾å’Œä½¿ç”¨è¯´æ˜ï¼ˆTypeScriptï¼‰
3. **å‰ç«¯é…ç½®ç•Œé¢** - ä¸ºå·¥å…·æä¾›ç”¨æˆ·å‹å¥½çš„é…ç½®ç•Œé¢ï¼ˆVue 3ï¼‰

### å·¥å…·ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    å‰ç«¯å›¾æ ‡é…ç½® (web/src/config/tools.ts)    â”‚
â”‚  å®šä¹‰å·¥å…·çš„å›¾æ ‡ã€æ ‡ç­¾ã€ä½¿ç”¨è¯´æ˜ç­‰å‰ç«¯å…ƒæ•°æ®     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           å‰ç«¯é…ç½®ç•Œé¢ (Vue 3)               â”‚
â”‚  ç”¨æˆ·é€šè¿‡è¡¨å•é…ç½®å·¥å…·å‚æ•°                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ å·¥å…·é…ç½® (JSON)
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           å·¥å…·æ³¨å†Œè¡¨ (Registry)               â”‚
â”‚  ç®¡ç†æ‰€æœ‰å·²æ³¨å†Œçš„å·¥å…·                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ å·¥å…·å®ä¾‹
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å·¥å…·å®ç° (Tool Interface)            â”‚
â”‚  æ‰§è¡Œå…·ä½“çš„ä¸šåŠ¡é€»è¾‘                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¼€å‘æµç¨‹æ€»ç»“

1. **åç«¯å¼€å‘** (`pkg/utools/your_tool/`)
   - åˆ›å»ºå·¥å…·æ–‡ä»¶å¹¶å®ç° `Tool` æ¥å£
   - å®šä¹‰ `ToolMetadata`ï¼ˆæ— éœ€é…ç½® Icon å­—æ®µï¼‰
   - å®šä¹‰ `ConfigSchema`
   - å®ç° `Execute()` æ–¹æ³•
   - åœ¨ `pkg/utools/init.go` ä¸­å¯¼å…¥

2. **å‰ç«¯å›¾æ ‡é…ç½®** (`web/src/config/tools.ts`)
   - å¯¼å…¥ Lucide å›¾æ ‡æˆ–å‡†å¤‡è‡ªå®šä¹‰å›¾æ ‡å›¾ç‰‡
   - æ·»åŠ å·¥å…·é…ç½®å¯¹è±¡ï¼ˆå›¾æ ‡ã€èƒŒæ™¯è‰²ã€æ ‡ç­¾ã€ä½¿ç”¨è¯´æ˜ï¼‰

3. **å‰ç«¯é…ç½®ç»„ä»¶** (`web/src/components/tools/`)
   - åˆ›å»º Vue ç»„ä»¶å®ç°é…ç½®è¡¨å•
   - åœ¨ç¼–è¾‘å™¨ä¸­æ³¨å†Œé…ç½®ç»„ä»¶

---

## ğŸ”¨ åç«¯å¼€å‘

### ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå·¥å…·ç›®å½•

åœ¨ `pkg/utools/` ä¸‹åˆ›å»ºä½ çš„å·¥å…·ç›®å½•ï¼š

```bash
mkdir pkg/utools/your_tool
cd pkg/utools/your_tool
```

### ç¬¬äºŒæ­¥ï¼šå®ç°å·¥å…·æ¥å£

åˆ›å»º `your_tool.go` æ–‡ä»¶ï¼Œå®ç° `Tool` æ¥å£ï¼š

```go
package your_tool

import (
    "auto-forge/pkg/utools"
    "fmt"
    "time"
)

// YourTool ä½ çš„å·¥å…·å®ç°
type YourTool struct {
    *utools.BaseTool
}

// NewYourTool åˆ›å»ºå·¥å…·å®ä¾‹
func NewYourTool() *YourTool {
    // 1. å®šä¹‰å·¥å…·å…ƒæ•°æ®
    metadata := &utools.ToolMetadata{
        Code:        "your_tool",           // å”¯ä¸€æ ‡è¯†ï¼Œå°å†™ä¸‹åˆ’çº¿
        Name:        "ä½ çš„å·¥å…·",             // æ˜¾ç¤ºåç§°
        Description: "å·¥å…·åŠŸèƒ½æè¿°",         // è¯¦ç»†æè¿°
        Category:    "automation",          // åˆ†ç±»: network, notification, data, automation
        Version:     "1.0.0",               // ç‰ˆæœ¬å·
        Author:      "Your Name",           // ä½œè€…
        AICallable:  true,                  // æ˜¯å¦å¯è¢« AI è°ƒç”¨
        Tags:        []string{"tag1", "tag2"}, // æ ‡ç­¾
    }

    // 2. å®šä¹‰é…ç½® Schemaï¼ˆJSON Schema æ ¼å¼ï¼‰
    schema := &utools.ConfigSchema{
        Type: "object",
        Properties: map[string]utools.PropertySchema{
            "param1": {
                Type:        "string",
                Title:       "å‚æ•°1",
                Description: "å‚æ•°1çš„æè¿°",
                Default:     "é»˜è®¤å€¼",
            },
            "param2": {
                Type:        "number",
                Title:       "å‚æ•°2",
                Description: "æ•°å­—ç±»å‹å‚æ•°",
                Default:     10.0,
                Minimum:     func() *float64 { v := 1.0; return &v }(),
                Maximum:     func() *float64 { v := 100.0; return &v }(),
            },
            "param3": {
                Type:        "string",
                Title:       "é€‰é¡¹å‚æ•°",
                Description: "ä¸‹æ‹‰é€‰æ‹©å‚æ•°",
                Enum:        []interface{}{"option1", "option2", "option3"},
                Default:     "option1",
            },
            "secret_param": {
                Type:        "string",
                Title:       "æ•æ„Ÿå‚æ•°",
                Description: "API Key ç­‰æ•æ„Ÿä¿¡æ¯",
                Secret:      true, // æ ‡è®°ä¸ºæ•æ„Ÿä¿¡æ¯ï¼Œä¼šåŠ å¯†å­˜å‚¨
            },
        },
        Required: []string{"param1"}, // å¿…å¡«å­—æ®µ
    }

    return &YourTool{
        BaseTool: utools.NewBaseTool(metadata, schema),
    }
}

// Execute æ‰§è¡Œå·¥å…·
func (t *YourTool) Execute(ctx *utools.ExecutionContext, config map[string]interface{}) (*utools.ExecutionResult, error) {
    startTime := time.Now()

    // 1. è§£æé…ç½®å‚æ•°
    param1, _ := config["param1"].(string)
    param2, _ := config["param2"].(float64)
    param3, _ := config["param3"].(string)

    // 2. æ‰§è¡Œå·¥å…·é€»è¾‘
    // ... ä½ çš„ä¸šåŠ¡ä»£ç  ...

    // 3. è¿”å›æ‰§è¡Œç»“æœ
    return &utools.ExecutionResult{
        Success:    true,
        Message:    "æ‰§è¡ŒæˆåŠŸ",
        Output: map[string]interface{}{
            "result": "æ‰§è¡Œç»“æœ",
            "param1": param1,
            "param2": param2,
        },
        DurationMs: time.Since(startTime).Milliseconds(),
    }, nil
}

// init è‡ªåŠ¨æ³¨å†Œå·¥å…·
func init() {
    tool := NewYourTool()
    if err := utools.Register(tool); err != nil {
        panic(fmt.Sprintf("Failed to register your tool: %v", err))
    }
}
```

### ç¬¬ä¸‰æ­¥ï¼šé…ç½® Schema è¯¦è§£

Schema å®šä¹‰äº†å·¥å…·çš„é…ç½®å‚æ•°ï¼Œæ”¯æŒå¤šç§æ•°æ®ç±»å‹ï¼š

#### å­—ç¬¦ä¸²ç±»å‹ (string)

```go
"url": {
    Type:        "string",
    Title:       "URL åœ°å€",
    Description: "ç›®æ ‡ URL",
    Format:      "uri",           // æ ¼å¼éªŒè¯: uri, email, date-time
    Pattern:     "^https://.*",   // æ­£åˆ™è¡¨è¾¾å¼éªŒè¯
    MinLength:   func() *int { v := 5; return &v }(),
    MaxLength:   func() *int { v := 200; return &v }(),
}
```

#### æ•°å­—ç±»å‹ (number)

```go
"timeout": {
    Type:        "number",
    Title:       "è¶…æ—¶æ—¶é—´",
    Description: "è¯·æ±‚è¶…æ—¶ï¼ˆç§’ï¼‰",
    Default:     30.0,
    Minimum:     func() *float64 { v := 1.0; return &v }(),
    Maximum:     func() *float64 { v := 300.0; return &v }(),
}
```

#### å¸ƒå°”ç±»å‹ (boolean)

```go
"enabled": {
    Type:        "boolean",
    Title:       "å¯ç”¨",
    Description: "æ˜¯å¦å¯ç”¨æ­¤åŠŸèƒ½",
    Default:     true,
}
```

#### æšä¸¾ç±»å‹ (enum)

```go
"method": {
    Type:        "string",
    Title:       "è¯·æ±‚æ–¹æ³•",
    Description: "HTTP è¯·æ±‚æ–¹æ³•",
    Enum:        []interface{}{"GET", "POST", "PUT", "DELETE"},
    Default:     "GET",
}
```

#### å¯¹è±¡ç±»å‹ (object)

```go
"headers": {
    Type:        "object",
    Title:       "è¯·æ±‚å¤´",
    Description: "HTTP è¯·æ±‚å¤´",
    Properties: map[string]utools.PropertySchema{
        "Authorization": {
            Type:  "string",
            Title: "è®¤è¯ä»¤ç‰Œ",
        },
    },
}
```

#### æ•°ç»„ç±»å‹ (array)

```go
"tags": {
    Type:        "array",
    Title:       "æ ‡ç­¾",
    Description: "æ ‡ç­¾åˆ—è¡¨",
    Items: &utools.PropertySchema{
        Type: "string",
    },
}
```

#### æ•æ„Ÿä¿¡æ¯ (secret)

```go
"api_key": {
    Type:        "string",
    Title:       "API Key",
    Description: "ç¬¬ä¸‰æ–¹æœåŠ¡çš„ API å¯†é’¥",
    Secret:      true, // æ ‡è®°ä¸ºæ•æ„Ÿä¿¡æ¯ï¼Œä¼šåŠ å¯†å­˜å‚¨
}
```

### ç¬¬å››æ­¥ï¼šå¯¼å…¥å·¥å…·æ¨¡å—

åœ¨ `pkg/utools/init.go` ä¸­å¯¼å…¥ä½ çš„å·¥å…·ï¼š

```go
package utools

import (
    _ "auto-forge/pkg/utools/http"
    _ "auto-forge/pkg/utools/email"
    _ "auto-forge/pkg/utools/health"
    _ "auto-forge/pkg/utools/your_tool"  // æ·»åŠ è¿™è¡Œ
)
```

### ç¬¬äº”æ­¥ï¼šæµ‹è¯•å·¥å…·

åˆ›å»ºå•å…ƒæµ‹è¯•æ–‡ä»¶ `your_tool_test.go`ï¼š

```go
package your_tool

import (
    "auto-forge/pkg/utools"
    "context"
    "testing"
)

func TestYourTool_Execute(t *testing.T) {
    tool := NewYourTool()

    ctx := &utools.ExecutionContext{
        Context: context.Background(),
        TaskID:  "test-task",
        UserID:  "test-user",
    }

    config := map[string]interface{}{
        "param1": "test value",
        "param2": 20.0,
        "param3": "option1",
    }

    result, err := tool.Execute(ctx, config)
    if err != nil {
        t.Fatalf("Execute failed: %v", err)
    }

    if !result.Success {
        t.Errorf("Expected success=true, got %v", result.Success)
    }
}

func TestYourTool_Validate(t *testing.T) {
    tool := NewYourTool()

    // æµ‹è¯•å¿…å¡«å­—æ®µç¼ºå¤±
    config := map[string]interface{}{
        "param2": 20.0,
    }

    err := tool.Validate(config)
    if err == nil {
        t.Error("Expected validation error for missing required field")
    }
}
```

è¿è¡Œæµ‹è¯•ï¼š

```bash
go test ./pkg/utools/your_tool -v
```

---

## ğŸ¨ å‰ç«¯å¼€å‘

### ç¬¬ä¸€æ­¥ï¼šæ·»åŠ å·¥å…·å›¾æ ‡å’Œå…ƒæ•°æ®é…ç½®

åœ¨ `web/src/config/tools.ts` ä¸­ä¸ºä½ çš„å·¥å…·æ·»åŠ å‰ç«¯é…ç½®ï¼ˆå›¾æ ‡ã€æ ‡ç­¾ã€ä½¿ç”¨è¯´æ˜ç­‰ï¼‰ï¼š

```typescript
import { YourIcon } from 'lucide-vue-next' // å¯¼å…¥ Lucide å›¾æ ‡

export const TOOL_CONFIGS: Record<string, ToolConfig> = {
  // ... å…¶ä»–å·¥å…·é…ç½®

  your_tool: {
    code: 'your_tool',
    title: 'ğŸ”§ ä½ çš„å·¥å…·',
    description: 'å·¥å…·åŠŸèƒ½æè¿°',
    icon: YourIcon,  // ä½¿ç”¨ Lucide å›¾æ ‡ç»„ä»¶
    // æˆ–ä½¿ç”¨å›¾ç‰‡è·¯å¾„: icon: '/icons/your-tool.png',
    iconBg: 'bg-gradient-to-br from-blue-500 to-indigo-600',  // å›¾æ ‡èƒŒæ™¯æ¸å˜è‰²
    usageDescription: 'è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜',
    usageItems: [
      { text: 'åŠŸèƒ½ç‰¹ç‚¹ 1' },
      { text: 'åŠŸèƒ½ç‰¹ç‚¹ 2' },
      { text: 'é€‚ç”¨åœºæ™¯ï¼šXXX' },
    ],
    tags: ['tag1', 'tag2', 'tag3'],
  },
}
```

**é…ç½®è¯´æ˜ï¼š**
- `icon`: æ”¯æŒä¸¤ç§æ–¹å¼
  - **Lucide å›¾æ ‡**ï¼ˆæ¨èï¼‰ï¼šä» `lucide-vue-next` å¯¼å…¥å›¾æ ‡ç»„ä»¶
  - **è‡ªå®šä¹‰å›¾ç‰‡**ï¼šæä¾›å›¾ç‰‡è·¯å¾„ï¼Œå¦‚ `'/icons/tool.png'`ï¼Œå›¾ç‰‡æ”¾åœ¨ `web/public/icons/` ç›®å½•
- `iconBg`: Tailwind CSS æ¸å˜èƒŒæ™¯ç±»åï¼Œç”¨äºå›¾æ ‡èƒŒæ™¯è‰²
- `usageDescription`: å·¥å…·ä½¿ç”¨è¯´æ˜
- `usageItems`: å·¥å…·ç‰¹ç‚¹å’Œä½¿ç”¨åœºæ™¯çš„åˆ—è¡¨
- `tags`: å·¥å…·æ ‡ç­¾ï¼Œç”¨äºæœç´¢å’Œåˆ†ç±»

**å¸¸ç”¨ Lucide å›¾æ ‡ï¼š**
- `Globe` - ç½‘ç»œ/HTTP ç›¸å…³
- `Mail` - é‚®ä»¶ç›¸å…³
- `Activity` - ç›‘æ§/å¥åº·æ£€æŸ¥
- `Shuffle` - è½¬æ¢/å¤„ç†
- `Zap` - ç¼“å­˜/æ€§èƒ½
- `MessageSquare` - æ¶ˆæ¯/é€šçŸ¥
- `Palette` - æ ¼å¼åŒ–/è¾“å‡º
- `FileJson` - æ–‡ä»¶/æ•°æ®
- `MessageCircle` - å¯¹è¯/èŠå¤©
- `Image` - å›¾ç‰‡ç›¸å…³

å®Œæ•´çš„å›¾æ ‡åˆ—è¡¨ï¼šhttps://lucide.dev/icons/

### ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé…ç½®ç»„ä»¶

åœ¨ `web/src/components/tools/` ä¸‹åˆ›å»º `YourToolConfig.vue`ï¼š

```vue
<template>
  <div class="space-y-4">
    <h3 class="text-sm font-semibold text-text-primary mb-3">ä½ çš„å·¥å…·é…ç½®</h3>

    <!-- å‚æ•°1 - æ–‡æœ¬è¾“å…¥ -->
    <div>
      <label class="block text-xs font-medium text-text-secondary mb-1.5">
        å‚æ•°1 <span class="text-error">*</span>
      </label>
      <input
        v-model="localConfig.param1"
        type="text"
        placeholder="è¯·è¾“å…¥å‚æ•°1"
        class="w-full px-3 py-2 text-sm border border-border-primary rounded-md focus:ring-2 focus:ring-primary focus:border-primary"
      />
    </div>

    <!-- å‚æ•°2 - æ•°å­—è¾“å…¥ -->
    <div>
      <label class="block text-xs font-medium text-text-secondary mb-1.5">
        å‚æ•°2
      </label>
      <input
        v-model.number="localConfig.param2"
        type="number"
        :min="1"
        :max="100"
        placeholder="è¾“å…¥æ•°å­— (1-100)"
        class="w-full px-3 py-2 text-sm border border-border-primary rounded-md focus:ring-2 focus:ring-primary focus:border-primary"
      />
    </div>

    <!-- å‚æ•°3 - ä¸‹æ‹‰é€‰æ‹© -->
    <div>
      <label class="block text-xs font-medium text-text-secondary mb-1.5">
        é€‰é¡¹å‚æ•°
      </label>
      <select
        v-model="localConfig.param3"
        class="w-full px-3 py-2 text-sm border border-border-primary rounded-md focus:ring-2 focus:ring-primary focus:border-primary"
      >
        <option value="option1">é€‰é¡¹1</option>
        <option value="option2">é€‰é¡¹2</option>
        <option value="option3">é€‰é¡¹3</option>
      </select>
    </div>

    <!-- æ•æ„Ÿå‚æ•° - å¯†ç è¾“å…¥ -->
    <div>
      <label class="block text-xs font-medium text-text-secondary mb-1.5">
        æ•æ„Ÿå‚æ•°
      </label>
      <input
        v-model="localConfig.secret_param"
        type="password"
        placeholder="è¾“å…¥ API Key"
        class="w-full px-3 py-2 text-sm border border-border-primary rounded-md focus:ring-2 focus:ring-primary focus:border-primary"
      />
      <p class="mt-1 text-xs text-text-tertiary">æ­¤ä¿¡æ¯å°†è¢«åŠ å¯†å­˜å‚¨</p>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, watch } from 'vue'

interface Props {
  config: Record<string, any>
}

interface Emits {
  (e: 'update:config', value: Record<string, any>): void
}

const props = defineProps<Props>()
const emit = defineEmits<Emits>()

// æœ¬åœ°é…ç½®çŠ¶æ€
const localConfig = ref({
  param1: props.config.param1 || '',
  param2: props.config.param2 || 10,
  param3: props.config.param3 || 'option1',
  secret_param: props.config.secret_param || '',
})

// ç›‘å¬é…ç½®å˜åŒ–å¹¶å‘çˆ¶ç»„ä»¶å‘é€æ›´æ–°
watch(
  localConfig,
  (newConfig) => {
    emit('update:config', newConfig)
  },
  { deep: true }
)
</script>
```

### ç¬¬ä¸‰æ­¥ï¼šæ³¨å†Œé…ç½®ç»„ä»¶

åœ¨å·¥ä½œæµç¼–è¾‘å™¨ä¸­æ³¨å†Œä½ çš„é…ç½®ç»„ä»¶ã€‚

æ‰¾åˆ° `web/src/pages/Workflows/editor.vue`ï¼Œåœ¨å·¥å…·é…ç½®éƒ¨åˆ†æ·»åŠ ä½ çš„ç»„ä»¶ï¼š

```vue
<script setup lang="ts">
import YourToolConfig from '@/components/tools/YourToolConfig.vue'

// å·¥å…·é…ç½®ç»„ä»¶æ˜ å°„
const toolConfigComponents = {
  http_request: HttpRequestConfig,
  send_email: EmailToolConfig,
  health_checker: HealthCheckerConfig,
  your_tool: YourToolConfig,  // æ·»åŠ è¿™è¡Œ
}
</script>
```

**æ³¨æ„ï¼š** å·¥å…·ä¼šè‡ªåŠ¨ä»åç«¯ API åŠ è½½å¹¶æ˜¾ç¤ºåœ¨å·¥å…·åˆ—è¡¨å’Œå·¥å…·é¢æ¿ä¸­ï¼Œå›¾æ ‡å’Œå…ƒæ•°æ®ä¼šä½¿ç”¨ `web/src/config/tools.ts` ä¸­çš„é…ç½®ã€‚æ— éœ€æ‰‹åŠ¨åœ¨å·¥å…·é¢æ¿ä¸­æ·»åŠ ã€‚

### ç»„ä»¶å¼€å‘æœ€ä½³å®è·µ

#### 1. ä½¿ç”¨å—æ§ç»„ä»¶

```vue
<script setup lang="ts">
// âœ… æ­£ç¡®ï¼šä½¿ç”¨æœ¬åœ°çŠ¶æ€ + watch
const localConfig = ref({ ...props.config })

watch(
  localConfig,
  (newConfig) => {
    emit('update:config', newConfig)
  },
  { deep: true }
)

// âŒ é”™è¯¯ï¼šç›´æ¥ä¿®æ”¹ props
const updateParam = (value) => {
  props.config.param1 = value // è¿™æ ·åšæ˜¯é”™è¯¯çš„ï¼
}
</script>
```

#### 2. æä¾›è¾“å…¥éªŒè¯

```vue
<template>
  <div>
    <input
      v-model="localConfig.email"
      type="email"
      :class="{ 'border-error': !isValidEmail }"
    />
    <p v-if="!isValidEmail" class="text-xs text-error mt-1">
      è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€
    </p>
  </div>
</template>

<script setup lang="ts">
import { computed } from 'vue'

const isValidEmail = computed(() => {
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
  return emailRegex.test(localConfig.value.email)
})
</script>
```

#### 3. æ·»åŠ å¸®åŠ©æ–‡æœ¬

```vue
<template>
  <div>
    <label class="flex items-center gap-1">
      å‚æ•°åç§°
      <Tooltip text="è¿™æ˜¯å‚æ•°çš„è¯¦ç»†è¯´æ˜" position="right">
        <HelpCircle class="w-3.5 h-3.5 text-text-tertiary" />
      </Tooltip>
    </label>
    <input v-model="localConfig.param" />
    <p class="text-xs text-text-tertiary mt-1">
      æç¤ºï¼šè¿™ä¸ªå‚æ•°çš„ä½¿ç”¨å»ºè®®
    </p>
  </div>
</template>
```

---

## ğŸ“ å®Œæ•´ç¤ºä¾‹ï¼šçŸ­ä¿¡å‘é€å·¥å…·

è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹æ¥æ¼”ç¤ºæ•´ä¸ªå¼€å‘æµç¨‹ã€‚

### åç«¯å®ç°

`pkg/utools/sms/sms_tool.go`:

```go
package sms

import (
    "auto-forge/pkg/utools"
    "fmt"
    "time"
)

type SMSTool struct {
    *utools.BaseTool
}

func NewSMSTool() *SMSTool {
    metadata := &utools.ToolMetadata{
        Code:        "send_sms",
        Name:        "å‘é€çŸ­ä¿¡",
        Description: "é€šè¿‡çŸ­ä¿¡æœåŠ¡å•†å‘é€çŸ­ä¿¡é€šçŸ¥",
        Category:    "notification",
        Version:     "1.0.0",
        Author:      "Cooper Team",
        AICallable:  true,
        Tags:        []string{"sms", "notification", "message"},
    }

    schema := &utools.ConfigSchema{
        Type: "object",
        Properties: map[string]utools.PropertySchema{
            "phone": {
                Type:        "string",
                Title:       "æ‰‹æœºå·ç ",
                Description: "æ¥æ”¶çŸ­ä¿¡çš„æ‰‹æœºå·ç ",
                Pattern:     "^1[3-9]\\d{9}$",
            },
            "message": {
                Type:        "string",
                Title:       "çŸ­ä¿¡å†…å®¹",
                Description: "è¦å‘é€çš„çŸ­ä¿¡å†…å®¹",
                MinLength:   func() *int { v := 1; return &v }(),
                MaxLength:   func() *int { v := 500; return &v }(),
            },
            "provider": {
                Type:        "string",
                Title:       "æœåŠ¡å•†",
                Description: "çŸ­ä¿¡æœåŠ¡æä¾›å•†",
                Enum:        []interface{}{"é˜¿é‡Œäº‘", "è…¾è®¯äº‘", "åä¸ºäº‘"},
                Default:     "é˜¿é‡Œäº‘",
            },
            "api_key": {
                Type:        "string",
                Title:       "API Key",
                Description: "çŸ­ä¿¡æœåŠ¡å•†çš„ API å¯†é’¥",
                Secret:      true,
            },
        },
        Required: []string{"phone", "message", "api_key"},
    }

    return &SMSTool{
        BaseTool: utools.NewBaseTool(metadata, schema),
    }
}

func (t *SMSTool) Execute(ctx *utools.ExecutionContext, config map[string]interface{}) (*utools.ExecutionResult, error) {
    startTime := time.Now()

    phone, _ := config["phone"].(string)
    message, _ := config["message"].(string)
    provider, _ := config["provider"].(string)
    apiKey, _ := config["api_key"].(string)

    // æ¨¡æ‹Ÿå‘é€çŸ­ä¿¡ï¼ˆå®é™…åº”è¯¥è°ƒç”¨çŸ­ä¿¡æœåŠ¡å•† APIï¼‰
    // ... å®é™…çš„çŸ­ä¿¡å‘é€ä»£ç  ...

    return &utools.ExecutionResult{
        Success: true,
        Message: fmt.Sprintf("çŸ­ä¿¡å·²å‘é€è‡³ %s", phone),
        Output: map[string]interface{}{
            "phone":    phone,
            "provider": provider,
            "sent_at":  time.Now().Unix(),
        },
        DurationMs: time.Since(startTime).Milliseconds(),
    }, nil
}

func init() {
    tool := NewSMSTool()
    if err := utools.Register(tool); err != nil {
        panic(fmt.Sprintf("Failed to register SMS tool: %v", err))
    }
}
```

### å‰ç«¯å›¾æ ‡é…ç½®

`web/src/config/tools.ts` ä¸­æ·»åŠ  SMS å·¥å…·é…ç½®ï¼š

```typescript
import { MessageSquare } from 'lucide-vue-next'

export const TOOL_CONFIGS: Record<string, ToolConfig> = {
  // ... å…¶ä»–å·¥å…·

  send_sms: {
    code: 'send_sms',
    title: 'ğŸ“± å‘é€çŸ­ä¿¡',
    description: 'é€šè¿‡çŸ­ä¿¡æœåŠ¡å•†å‘é€çŸ­ä¿¡é€šçŸ¥',
    icon: MessageSquare,
    iconBg: 'bg-gradient-to-br from-green-500 to-emerald-600',
    usageDescription: 'æ”¯æŒå¤šå®¶çŸ­ä¿¡æœåŠ¡å•†å‘é€çŸ­ä¿¡é€šçŸ¥',
    usageItems: [
      { text: 'æ”¯æŒé˜¿é‡Œäº‘ã€è…¾è®¯äº‘ã€åä¸ºäº‘ç­‰ä¸»æµçŸ­ä¿¡æœåŠ¡å•†' },
      { text: 'è‡ªåŠ¨éªŒè¯æ‰‹æœºå·æ ¼å¼' },
      { text: 'API Key åŠ å¯†å­˜å‚¨ï¼Œå®‰å…¨å¯é ' },
      { text: 'é€‚ç”¨åœºæ™¯ï¼šéªŒè¯ç å‘é€ã€é€šçŸ¥æé†’ã€è¥é”€æ¨å¹¿ç­‰' },
    ],
    tags: ['SMS', 'Notification', 'Message', 'Alert'],
  },
}
```

### å‰ç«¯é…ç½®ç»„ä»¶å®ç°

`web/src/components/tools/SMSToolConfig.vue`:

```vue
<template>
  <div class="space-y-4">
    <h3 class="text-sm font-semibold text-text-primary mb-3">çŸ­ä¿¡å‘é€é…ç½®</h3>

    <!-- æ‰‹æœºå· -->
    <div>
      <label class="block text-xs font-medium text-text-secondary mb-1.5">
        æ‰‹æœºå·ç  <span class="text-error">*</span>
      </label>
      <input
        v-model="localConfig.phone"
        type="tel"
        placeholder="è¯·è¾“å…¥æ‰‹æœºå·ç "
        :class="[
          'w-full px-3 py-2 text-sm border rounded-md focus:ring-2 focus:ring-primary focus:border-primary',
          !isValidPhone && localConfig.phone ? 'border-error' : 'border-border-primary'
        ]"
      />
      <p v-if="!isValidPhone && localConfig.phone" class="text-xs text-error mt-1">
        è¯·è¾“å…¥æœ‰æ•ˆçš„æ‰‹æœºå·ç 
      </p>
    </div>

    <!-- çŸ­ä¿¡å†…å®¹ -->
    <div>
      <label class="block text-xs font-medium text-text-secondary mb-1.5">
        çŸ­ä¿¡å†…å®¹ <span class="text-error">*</span>
      </label>
      <textarea
        v-model="localConfig.message"
        rows="4"
        placeholder="è¯·è¾“å…¥çŸ­ä¿¡å†…å®¹"
        maxlength="500"
        class="w-full px-3 py-2 text-sm border border-border-primary rounded-md focus:ring-2 focus:ring-primary focus:border-primary resize-none"
      ></textarea>
      <p class="text-xs text-text-tertiary mt-1">
        {{ localConfig.message?.length || 0 }} / 500 å­—
      </p>
    </div>

    <!-- æœåŠ¡å•†é€‰æ‹© -->
    <div>
      <label class="block text-xs font-medium text-text-secondary mb-1.5">
        æœåŠ¡å•†
      </label>
      <select
        v-model="localConfig.provider"
        class="w-full px-3 py-2 text-sm border border-border-primary rounded-md focus:ring-2 focus:ring-primary focus:border-primary"
      >
        <option value="é˜¿é‡Œäº‘">é˜¿é‡Œäº‘</option>
        <option value="è…¾è®¯äº‘">è…¾è®¯äº‘</option>
        <option value="åä¸ºäº‘">åä¸ºäº‘</option>
      </select>
    </div>

    <!-- API Key -->
    <div>
      <label class="block text-xs font-medium text-text-secondary mb-1.5">
        API Key <span class="text-error">*</span>
      </label>
      <input
        v-model="localConfig.api_key"
        type="password"
        placeholder="è¾“å…¥çŸ­ä¿¡æœåŠ¡å•†çš„ API Key"
        class="w-full px-3 py-2 text-sm border border-border-primary rounded-md focus:ring-2 focus:ring-primary focus:border-primary"
      />
      <p class="text-xs text-text-tertiary mt-1">
        <Lock class="w-3 h-3 inline" /> æ­¤ä¿¡æ¯å°†è¢«åŠ å¯†å­˜å‚¨
      </p>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, computed, watch } from 'vue'
import { Lock } from 'lucide-vue-next'

interface Props {
  config: Record<string, any>
}

interface Emits {
  (e: 'update:config', value: Record<string, any>): void
}

const props = defineProps<Props>()
const emit = defineEmits<Emits>()

const localConfig = ref({
  phone: props.config.phone || '',
  message: props.config.message || '',
  provider: props.config.provider || 'é˜¿é‡Œäº‘',
  api_key: props.config.api_key || '',
})

// æ‰‹æœºå·éªŒè¯
const isValidPhone = computed(() => {
  if (!localConfig.value.phone) return true
  return /^1[3-9]\d{9}$/.test(localConfig.value.phone)
})

watch(
  localConfig,
  (newConfig) => {
    emit('update:config', newConfig)
  },
  { deep: true }
)
</script>
```

---

## ğŸ¯ æœ€ä½³å®è·µ

### 1. é”™è¯¯å¤„ç†

```go
func (t *YourTool) Execute(ctx *utools.ExecutionContext, config map[string]interface{}) (*utools.ExecutionResult, error) {
    startTime := time.Now()

    // éªŒè¯é…ç½®
    if err := t.Validate(config); err != nil {
        return &utools.ExecutionResult{
            Success:    false,
            Message:    "é…ç½®éªŒè¯å¤±è´¥",
            Error:      err.Error(),
            DurationMs: time.Since(startTime).Milliseconds(),
        }, err
    }

    // æ£€æŸ¥ä¸Šä¸‹æ–‡è¶…æ—¶
    select {
    case <-ctx.Context.Done():
        return &utools.ExecutionResult{
            Success:    false,
            Message:    "æ‰§è¡Œè¶…æ—¶",
            Error:      "context deadline exceeded",
            DurationMs: time.Since(startTime).Milliseconds(),
        }, ctx.Context.Err()
    default:
    }

    // æ‰§è¡Œä¸šåŠ¡é€»è¾‘...
}
```

### 2. æ—¥å¿—è®°å½•

```go
import log "auto-forge/pkg/logger"

func (t *YourTool) Execute(ctx *utools.ExecutionContext, config map[string]interface{}) (*utools.ExecutionResult, error) {
    log.Info("æ‰§è¡Œå·¥å…·: %s, ä»»åŠ¡ID: %s", t.GetMetadata().Name, ctx.TaskID)

    // ... æ‰§è¡Œé€»è¾‘ ...

    log.Info("å·¥å…·æ‰§è¡ŒæˆåŠŸ: %s, è€—æ—¶: %dms", t.GetMetadata().Name, result.DurationMs)
    return result, nil
}
```

### 3. æ•æ„Ÿä¿¡æ¯å¤„ç†

åç«¯ä¼šè‡ªåŠ¨åŠ å¯†æ ‡è®°ä¸º `Secret: true` çš„å­—æ®µï¼Œå‰ç«¯ä½¿ç”¨ `type="password"` è¾“å…¥æ¡†ã€‚

### 4. æµ‹è¯•è¦†ç›–

- å•å…ƒæµ‹è¯•ï¼šæµ‹è¯•å·¥å…·çš„æ ¸å¿ƒé€»è¾‘
- é›†æˆæµ‹è¯•ï¼šæµ‹è¯•å·¥å…·åœ¨å®é™…ç¯å¢ƒä¸­çš„è¿è¡Œ
- é…ç½®éªŒè¯æµ‹è¯•ï¼šæµ‹è¯•å„ç§é…ç½®å‚æ•°çš„éªŒè¯é€»è¾‘

---

## â“ å¸¸è§é—®é¢˜

### Q1: å·¥å…·æœªå‡ºç°åœ¨å·¥å…·åˆ—è¡¨ä¸­

**åŸå› **ï¼šå·¥å…·æœªæ­£ç¡®æ³¨å†Œ

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ `init()` å‡½æ•°æ˜¯å¦æ­£ç¡®è°ƒç”¨ `utools.Register()`
2. æ£€æŸ¥ `pkg/utools/init.go` æ˜¯å¦å¯¼å…¥äº†ä½ çš„å·¥å…·åŒ…
3. é‡æ–°ç¼–è¯‘åç«¯ï¼š`go build ./cmd/main.go`

### Q2: é…ç½®ç»„ä»¶ä¸æ˜¾ç¤º

**åŸå› **ï¼šç»„ä»¶æœªåœ¨ç¼–è¾‘å™¨ä¸­æ³¨å†Œ

**è§£å†³æ–¹æ¡ˆ**ï¼š
åœ¨ `web/src/pages/Workflows/editor.vue` çš„ `toolConfigComponents` ä¸­æ·»åŠ ä½ çš„ç»„ä»¶æ˜ å°„ã€‚

### Q3: å‚æ•°éªŒè¯å¤±è´¥

**åŸå› **ï¼šSchema å®šä¹‰ä¸å®é™…é…ç½®ä¸åŒ¹é…

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ `Required` å­—æ®µæ˜¯å¦æ­£ç¡®
2. æ£€æŸ¥å­—æ®µç±»å‹æ˜¯å¦åŒ¹é…
3. æ£€æŸ¥æšä¸¾å€¼ã€æœ€å°/æœ€å¤§å€¼ç­‰çº¦æŸ

### Q4: å¦‚ä½•è°ƒè¯•å·¥å…·æ‰§è¡Œ

**åç«¯è°ƒè¯•**ï¼š
```go
log.Debug("é…ç½®å‚æ•°: %+v", config)
log.Debug("æ‰§è¡Œä¸Šä¸‹æ–‡: TaskID=%s, UserID=%s", ctx.TaskID, ctx.UserID)
```

**å‰ç«¯è°ƒè¯•**ï¼š
```vue
<script setup lang="ts">
watch(localConfig, (newConfig) => {
  console.log('é…ç½®æ›´æ–°:', newConfig)
  emit('update:config', newConfig)
}, { deep: true })
</script>
```

---

## ğŸ“š å‚è€ƒèµ„æº

- [JSON Schema è§„èŒƒ](https://json-schema.org/)
- [Vue 3 ç»„åˆå¼ API](https://cn.vuejs.org/guide/extras/composition-api-faq.html)
- [Go æ¥å£æœ€ä½³å®è·µ](https://golang.org/doc/effective_go#interfaces)
- [Cooper ç»„ä»¶å¼€å‘è§„èŒƒ](./COMPONENT_DEVELOPMENT.md)

---

## ğŸ¤ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœåœ¨å·¥å…·å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹ç°æœ‰å·¥å…·çš„å®ç°ä½œä¸ºå‚è€ƒï¼ˆ`pkg/utools/http/`, `pkg/utools/email/`ï¼‰
2. é˜…è¯»æ ¸å¿ƒæ¥å£å®šä¹‰ï¼ˆ`pkg/utools/types.go`ï¼‰
3. æäº¤ Issueï¼š[GitHub Issues](https://github.com/CooperJiang/Cooper/issues)

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.1
**æœ€åæ›´æ–°**: 2025-01-15
**ç»´æŠ¤è€…**: Cooper Team

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.1 (2025-01-15)
- ç§»é™¤åç«¯å·¥å…·å…ƒæ•°æ®ä¸­çš„ `Icon` å­—æ®µ
- æ–°å¢å‰ç«¯å·¥å…·å›¾æ ‡é…ç½®ç³»ç»Ÿ (`web/src/config/tools.ts`)
- æ”¯æŒ Lucide å›¾æ ‡ç»„ä»¶å’Œè‡ªå®šä¹‰å›¾ç‰‡è·¯å¾„
- æ·»åŠ å·¥å…·å›¾æ ‡é…ç½®æœ€ä½³å®è·µå’Œå¸¸ç”¨å›¾æ ‡åˆ—è¡¨

### v1.0 (2025-01-13)
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
